---
layout: default
title: "Manga Viewer"
use_main_css: true
# Si NO quieres que meta el header del layout: include_header: false
---

<!-- Appbar simple de la home -->
<div class="mcv-appbar" style="position:sticky;top:0;z-index:10;display:flex;gap:12px;align-items:center;padding:10px 16px;border-bottom:1px solid #1c2128;background:rgba(18,22,27,.9);backdrop-filter:blur(6px)">
  <strong class="mcv-brand" style="color:#e6e9ef">Mangas</strong>
  <input id="q" class="mcv-search" placeholder="Buscar..." style="margin-left:auto;background:#12161b;color:#e6e9ef;border:1px solid #1c2128;padding:8px 12px;border-radius:10px;outline:none" />
</div>

<section class="mcv-section" style="max-width:1100px;margin:0 auto;padding:20px 16px">
  <h2 class="mcv-h2" style="margin:6px 4px 12px;font-size:1.25rem;color:#e6e9ef">Catálogo</h2>

  <div id="grid" class="mcv-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(210px,1fr));gap:16px"></div>
  <div id="msg" class="mcv-error mcv-hidden" style="display:none;margin-top:8px;padding:10px 12px;background:#2b1320;border:1px solid #4e1e36;color:#f0a3b8;border-radius:10px"></div>
</section>

<script>
(async () => {
  const BASE = '{{ site.baseurl }}'; // ← ahora SÍ se resuelve porque este archivo tiene front matter

  const grid = document.getElementById('grid');
  const msg  = document.getElementById('msg');
  const Q    = document.getElementById('q');

  function card({ title, url, cover, tags = [], latest = "" }) {
    const a = document.createElement('a');
    a.href = BASE + (url?.startsWith('/') ? url : '/' + url);
    a.className = 'mcv-card';
    a.style.cssText = 'display:flex;flex-direction:column;text-decoration:none;color:inherit;background:#12161b;border:1px solid #1c2128;border-radius:14px;overflow:hidden;transition:transform .12s,border-color .12s';
    a.onmouseenter = () => { a.style.transform='translateY(-2px)'; a.style.borderColor='#263041'; };
    a.onmouseleave = () => { a.style.transform=''; a.style.borderColor='#1c2128'; };

    a.innerHTML = `
      <img class="mcv-cover" loading="lazy" decoding="async"
           src="${BASE}/${cover}" alt="${title}"
           style="width:100%;aspect-ratio:3/4;object-fit:cover;display:block">
      <div class="mcv-info" style="padding:10px 12px;color:#e6e9ef">
        <h3 class="mcv-title" style="margin:0 0 6px;font-size:1rem">${title}</h3>
        <div class="mcv-chips" style="display:flex;flex-wrap:wrap;gap:6px">
          ${(tags||[]).map(t => `<span class="mcv-chip" style="background:#1f2937;color:#9aa3af;padding:2px 8px;border-radius:999px;font-size:.75rem;border:1px solid #1c2128">${t}</span>`).join('')}
        </div>
        <div class="mcv-meta" style="margin-top:6px;color:#9aa3af;font-size:.875rem">Último: ${latest || '-'}</div>
      </div>`;
    return a;
  }

  const render = (list=[]) => {
    grid.innerHTML = '';
    list.forEach(item => grid.appendChild(card(item)));
  };

  try {
    // Lee /catalogo.json en la RAÍZ del repo
    const res = await fetch(BASE + '/catalogo.json', { cache: 'no-cache' });
    if (!res.ok) throw new Error('HTTP ' + res.status);
    const items = await res.json();
    render(items);

    Q.addEventListener('input', () => {
      const q = Q.value.trim().toLowerCase();
      const filtered = !q ? items : items.filter(it =>
        (it.title||'').toLowerCase().includes(q) ||
        (it.tags||[]).some(t => (t||'').toLowerCase().includes(q))
      );
      render(filtered);
    });
  } catch (e) {
    msg.textContent = 'No se pudo cargar el catálogo: ' + e.message;
    msg.style.display = 'block';
  }
})();
</script>
